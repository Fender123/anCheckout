"use strict";angular.module("anCheckoutApp",["ngResource","ngRoute","ngSanitize","ngTouch","ui.sortable","colorpicker.module"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/settings",{templateUrl:"views/settings.html",controller:"SettingsCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("anCheckoutApp").controller("MainCtrl",["$scope","$sce","products","cart",function(a,b,c,d){a.cart=d;var e=c.getProducts();a.products=e,a.activeTab=c.firstGroup||"Andere",a.showTab=function(b){a.activeTab=b},a.formatName=function(a){return b.trustAsHtml(-1===(a+"").indexOf(",")?a:a.split(",").join("<br />"))}}]),angular.module("anCheckoutApp").controller("SettingsCtrl",["$scope","products","$sce",function(a,b,c){var d=b.getProducts();a.products=d,a.editedProduct=null,a.editedProductBackup=null,a.productsImportExport="",a.save=function(){b.saveProducts(a.products)},a.reset=function(){b.resetProducts(),d=b.getProducts(),a.products=d,a.editedProduct=null,a.editedProductBackup=null},a.edit=function(b){a.editedProduct=b,a.editedProductBackup=JSON.parse(JSON.stringify(b))},a.add=function(){var c={name:"",price:0,color:"#eee",group:b.firstGroup};a.products[c.group].products.push(c),a.editedProduct=c,a.editedProductBackup=c},a.resetEditedProduct=function(){a:for(var b in a.products)if(a.products.hasOwnProperty(b)){var c=a.products[b];if("undefined"==typeof c.products)continue;for(var d=c.products.length-1;d>=0;d--){var e=c.products[d];if(e===a.editedProduct){a.products[b].products[d]=a.editedProductBackup,a.editedProduct=a.products[b].products[d];break a}}}},a.deleteEditedProduct=function(){a:for(var b in a.products)if(a.products.hasOwnProperty(b)){var c=a.products[b];if("undefined"==typeof c.products)continue;for(var d=c.products.length-1;d>=0;d--){var e=c.products[d];if(e===a.editedProduct){a.products[b].products.splice(d,1),a.editedProduct=null;break a}}}},a.formatName=function(a){return c.trustAsHtml(-1===(a+"").indexOf(",")?a:a.split(",").join("<br />"))},a.importProducts=function(){try{var c=angular.fromJson(a.productsImportExport);a.products=c,b.saveProducts(c)}catch(d){window.alert("Die Eingegeben Daten sind ungültig!")}},a.exportProducts=function(){a.productsImportExport=angular.toJson(a.products),window.alert("Bitte den Text aus dem Textfeld kopieren und über die Importfunktion auf einem anderen Geräte einspielen.")}}]),angular.module("anCheckoutApp").filter("formatList",function(){return function(a){return(a+"").replace(/,/g,", ")}}),angular.module("anCheckoutApp").filter("orderObjectBy",function(){return function(a,b,c){var d=[];return angular.forEach(a,function(a){d.push(a)}),d.sort(function(a,c){return a[b]>c[b]?1:-1}),c&&d.reverse(),d}}),function(){var a=!1;angular.module("anCheckoutApp").directive("ngTap",function(){return function(b,c,d){var e=!1;return a===!1&&(e=!0,c.bind("click",function(){return b.$apply(d.ngTap)})),c.bind("touchstart",function(){return a=!0,e===!0&&(c.unbind("click"),e=!1),b.$apply(d.ngTap)})}})}(),function(){var a="prds",b="#FF3333",c="#FFABAB",d="#FFFF00",e="#00BD00",f="#FF9933",g="#FCDCC2",h="#66CCFF",i="#CCFF99",j="#FFFFFF",k=[{name:"Haxen",price:7.2,color:j,group:"Essen"},{name:"1/2 Hähnchen",price:6,color:i,group:"Essen"},{name:"Fleischbrot,Salat,Weißwürste",price:4.5,color:h,group:"Essen"},{name:"Pommes,Rettich",price:2.6,color:g,group:"Essen"},{name:"1l Bier",price:6.4,color:d,group:"Essen"},{name:"1/2l Bier,1/4l Wein,LKW",price:3.3,color:c,group:"Essen"},{name:"Schorle / Pils,Currywurst,Wilde Kartoffeln,Käse",price:3,color:e,group:"Essen"},{name:"Cola / Fanta,Sprudel / A-Schorle,Wurst,Hering",price:2.8,color:f,group:"Essen"},{name:"Pfand",price:2,color:b,group:"Essen"},{name:"",price:0,color:"transparent",group:"Essen"},{name:"",price:0,color:"transparent",group:"Essen"},{name:"",price:0,color:"transparent",group:"Essen"}];angular.module("anCheckoutApp").factory("products",function(){for(var b={length:0},c=0;c<k.length;c++){var d=k[c],e=d.group||"Andere";b[e]||(b[e]={name:e,products:[],length:0},b.length++),b[e].length++,b[e].products.push(d)}return{getProducts:function(){var c=localStorage.getItem(a);return angular.fromJson(c?c:angular.toJson(b))},firstGroup:k[0].group,resetProducts:function(){localStorage.removeItem(a)},saveProducts:function(b){localStorage.setItem(a,angular.toJson(b))}}})}(),angular.module("anCheckoutApp").factory("cart",function(){var a=function(){};return a.products={length:0},a.buy=function(b,c){"number"!=typeof c&&(c=1),a.products[b.name]?a.products[b.name].count+=c:(a.products[b.name]={name:b.name,price:b.price,color:b.color,count:c,num:a.products.length},a.products.length++)},a.remove=function(b){a.products[b.name]&&(a.products[b.name].count--,0===a.products[b.name].count&&(delete a.products[b.name],a.products.length--))},a.overallCount=function(){var b=0;return angular.forEach(a.products,function(a){a.name&&(b+=a.count)}),b},a.overallSum=function(){var b=0;return angular.forEach(a.products,function(a){a.name&&(b+=a.count*a.price)}),b},a.removeAll=function(){a.products={length:0}},a});