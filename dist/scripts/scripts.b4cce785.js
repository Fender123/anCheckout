"use strict";angular.module("anCheckoutApp",["ngResource","ngRoute","ngSanitize","ngTouch","ui.sortable","colorpicker.module"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/settings",{templateUrl:"views/settings.html",controller:"SettingsCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("anCheckoutApp").controller("MainCtrl",["$scope","$sce","products","cart",function(a,b,c,d){a.cart=d;var e=c.getProducts();a.products=e,a.activeTab=c.firstGroup||"Andere",a.showTab=function(b){a.activeTab=b},a.formatName=function(a){return b.trustAsHtml(-1===(a+"").indexOf(",")?a:a.split(",").join("<br />"))}}]),angular.module("anCheckoutApp").controller("SettingsCtrl",["$scope","products","$sce",function(a,b,c){var d=b.getProducts();a.products=d,a.editedProduct=null,a.editedProductBackup=null,a.productsImportExport="",a.save=function(){b.saveProducts(a.products)},a.reset=function(){b.resetProducts(),d=b.getProducts(),a.products=d,a.editedProduct=null,a.editedProductBackup=null},a.edit=function(b){a.editedProduct=b,a.editedProductBackup=JSON.parse(JSON.stringify(b))},a.add=function(){var c={name:"",price:0,color:"#eee",group:b.firstGroup};a.products[c.group].products.push(c),a.editedProduct=c,a.editedProductBackup=c},a.resetEditedProduct=function(){a:for(var b in a.products)if(a.products.hasOwnProperty(b)){var c=a.products[b];if("undefined"==typeof c.products)continue;for(var d=c.products.length-1;d>=0;d--){var e=c.products[d];if(e===a.editedProduct){a.products[b].products[d]=a.editedProductBackup,a.editedProduct=a.products[b].products[d];break a}}}},a.deleteEditedProduct=function(){a:for(var b in a.products)if(a.products.hasOwnProperty(b)){var c=a.products[b];if("undefined"==typeof c.products)continue;for(var d=c.products.length-1;d>=0;d--){var e=c.products[d];if(e===a.editedProduct){a.products[b].products.splice(d,1),a.editedProduct=null;break a}}}},a.formatName=function(a){return c.trustAsHtml(-1===(a+"").indexOf(",")?a:a.split(",").join("<br />"))},a.importProducts=function(){try{var c=angular.fromJson(a.productsImportExport);a.products=c,b.saveProducts(c)}catch(d){window.alert("Die Eingegeben Daten sind ungültig!")}},a.exportProducts=function(){a.productsImportExport=angular.toJson(a.products),window.alert("Bitte den Text aus dem Textfeld kopieren und über die Importfunktion auf einem anderen Geräte einspielen.")}}]),angular.module("anCheckoutApp").filter("formatList",function(){return function(a){return(a+"").replace(/,/g,", ")}}),angular.module("anCheckoutApp").filter("orderObjectBy",function(){return function(a,b,c){var d=[];return angular.forEach(a,function(a){d.push(a)}),d.sort(function(a,c){return a[b]>c[b]?1:-1}),c&&d.reverse(),d}}),function(){var a=!1;angular.module("anCheckoutApp").directive("ngTap",function(){return function(b,c,d){var e=!1;return a===!1&&(e=!0,c.bind("click",function(){return b.$apply(d.ngTap)})),c.bind("touchstart",function(){return a=!0,e===!0&&(c.unbind("click"),e=!1),b.$apply(d.ngTap)})}})}(),function(){var a="prds",b=[{name:"Fleischbrot,Salat,Weißwürste",price:4.3,color:"#66CCFF",group:"Essen"},{name:"Pommes,Rettich",price:2.3,color:"#FCDCC2",group:"Essen"},{name:"1/2l Bier,1/4l Wein",price:3.3,color:"#FFABAB",group:"Essen"},{name:"1/2 Hähnchen",price:5.9,color:"#CCFF99",group:"Essen"},{name:"Wurst",price:2.5,color:"#FF9933",group:"Essen"},{name:"1l Bier",price:6.4,color:"#FFFF00",group:"Essen"},{name:"Haxen",price:6.9,color:"#FFFFFF",group:"Essen"},{name:"LKW",price:3.3,color:"#FFABAB",group:"Essen"},{name:"Schorle",price:2.8,color:"#00BD00",group:"Essen"},{name:"Currywurst,Wilde Kartoffeln,Käse,Hering",price:2.8,color:"#00BD00",group:"Essen"},{name:"Sprudel,A-Schorle,Cola,Fanta",price:2.5,color:"#FF9933",group:"Essen"},{name:"Pfand",price:2,color:"#FF3333",group:"Essen"}];angular.module("anCheckoutApp").factory("products",function(){for(var c={length:0},d=0;d<b.length;d++){var e=b[d],f=e.group||"Andere";c[f]||(c[f]={name:f,products:[],length:0},c.length++),c[f].length++,c[f].products.push(e)}return{getProducts:function(){var b=localStorage.getItem(a);return angular.fromJson(b?b:angular.toJson(c))},firstGroup:b[0].group,resetProducts:function(){localStorage.removeItem(a)},saveProducts:function(b){localStorage.setItem(a,angular.toJson(b))}}})}(),angular.module("anCheckoutApp").factory("cart",function(){var a=function(){};return a.products={length:0},a.buy=function(b,c){"number"!=typeof c&&(c=1),a.products[b.name]?a.products[b.name].count+=c:(a.products[b.name]={name:b.name,price:b.price,color:b.color,count:c,num:a.products.length},a.products.length++)},a.remove=function(b){a.products[b.name]&&(a.products[b.name].count--,0===a.products[b.name].count&&(delete a.products[b.name],a.products.length--))},a.overallCount=function(){var b=0;return angular.forEach(a.products,function(a){a.name&&(b+=a.count)}),b},a.overallSum=function(){var b=0;return angular.forEach(a.products,function(a){a.name&&(b+=a.count*a.price)}),b},a.removeAll=function(){a.products={length:0}},a});